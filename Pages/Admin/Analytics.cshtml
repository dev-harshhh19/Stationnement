@page
@model Stationnement.Web.Pages.Admin.AnalyticsModel
@{
    ViewData["Title"] = "Analytics";
    Layout = "_AdminLayout";
}

<div class="mb-6">
    <h2 class="text-xl font-semibold text-gray-900">Analytics Dashboard</h2>
    <p class="text-gray-500">Revenue and usage statistics</p>
</div>

<div class="grid lg:grid-cols-4 gap-6 mb-8">
    <div class="bg-white rounded-xl p-6 shadow-sm">
        <p class="text-gray-500 text-sm">Revenue This Month</p>
        <p class="text-2xl font-bold text-gray-900" id="revMonth">â‚¹0</p>
    </div>
    <div class="bg-white rounded-xl p-6 shadow-sm">
        <p class="text-gray-500 text-sm">Reservations This Week</p>
        <p class="text-2xl font-bold text-gray-900" id="resWeek">0</p>
    </div>
    <div class="bg-white rounded-xl p-6 shadow-sm">
        <p class="text-gray-500 text-sm">New Users This Month</p>
        <p class="text-2xl font-bold text-gray-900" id="newUsers">0</p>
    </div>
    <div class="bg-white rounded-xl p-6 shadow-sm">
        <p class="text-gray-500 text-sm">Total Locations</p>
        <p class="text-2xl font-bold text-gray-900" id="locations">0</p>
    </div>
</div>

<div class="bg-white rounded-xl shadow-sm p-6">
    <h3 class="text-lg font-semibold text-gray-900 mb-4">Revenue Overview</h3>
    <div class="h-64 flex items-center justify-center bg-gray-50 rounded-lg">
        <p class="text-gray-500">ðŸ“Š Charts coming in future update</p>
    </div>
</div>

@section Scripts {
<script>
const token = localStorage.getItem('adminAccessToken');
document.addEventListener('DOMContentLoaded', async () => {
    try {
        const res = await fetch('/api/admin/stats', { headers: { 'Authorization': `Bearer ${token}` } });
        const data = await res.json();
        if (data.success) {
            document.getElementById('revMonth').textContent = 'â‚¹' + (data.data.revenueThisMonth || 0).toLocaleString();
            document.getElementById('resWeek').textContent = (data.data.reservationsThisWeek || 0).toLocaleString();
            document.getElementById('newUsers').textContent = (data.data.newUsersThisMonth || 0).toLocaleString();
            document.getElementById('locations').textContent = (data.data.totalLocations || 0).toLocaleString();
        }
    } catch (e) { console.error(e); }
});
</script>
}
